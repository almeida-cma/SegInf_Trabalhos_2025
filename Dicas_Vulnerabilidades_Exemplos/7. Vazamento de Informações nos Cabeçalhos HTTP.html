<!DOCTYPE html>
<html>
<head>
    <title>Simula√ß√£o: Vazamento em Cabe√ßalhos HTTP</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .demo-area {
            border: 1px solid #ccc;
            padding: 15px;
            margin: 20px 0;
            background-color: #f9f9f9;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
            margin: 5px;
        }
        .vulnerable {
            background-color: #ffdddd;
            border-left: 5px solid #f44336;
            padding: 10px;
        }
        .secure {
            background-color: #ddffdd;
            border-left: 5px solid #4CAF50;
            padding: 10px;
        }
        .headers {
            background-color: #eee;
            padding: 10px;
            font-family: monospace;
            white-space: pre;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Simula√ß√£o: Vazamento de Informa√ß√µes nos Cabe√ßalhos HTTP</h1>
    
    <div class="vulnerable">
        <h2>‚ùå Cen√°rio Vulner√°vel (Cabe√ßalhos Reveladores)</h2>
        <p>Neste cen√°rio, os cabe√ßalhos HTTP revelam detalhes sobre a tecnologia do servidor.</p>
        
        <div class="demo-area">
            <h3>Demonstra√ß√£o:</h3>
            <button onclick="fetchVulnerableHeaders()">Buscar Cabe√ßalhos Vulner√°veis</button>
            <div id="vulnerableHeaders"></div>
            
            <p>Problemas demonstrados:</p>
            <ul>
                <li>Revela√ß√£o da vers√£o exata do servidor web (ex: Apache 2.4.29)</li>
                <li>Exposi√ß√£o da vers√£o do PHP/Node.js/outras tecnologias</li>
                <li>Informa√ß√£o sobre m√≥dulos e extens√µes habilitadas</li>
                <li>Facilita ataques direcionados a vulnerabilidades espec√≠ficas</li>
            </ul>
            
            <h4>Exemplo de cabe√ßalhos reveladores:</h4>
            <div class="headers">
Server: Apache/2.4.29 (Ubuntu)
X-Powered-By: PHP/7.2.24-0ubuntu0.18.04.6
X-AspNetMvc-Version: 5.2
X-AspNet-Version: 4.0.30319
            </div>
        </div>
    </div>
    
    <div class="secure">
        <h2>‚úÖ Cen√°rio Seguro (Cabe√ßalhos Ocultos)</h2>
        <p>Removendo ou modificando cabe√ßalhos que revelam informa√ß√µes sens√≠veis.</p>
        
        <div class="demo-area">
            <h3>Como implementar:</h3>
            
            <table>
                <tr>
                    <th>Cabe√ßalho</th>
                    <th>Problema</th>
                    <th>Solu√ß√£o</th>
                </tr>
                <tr>
                    <td>Server</td>
                    <td>Revela servidor e vers√£o</td>
                    <td>Apache: ServerTokens Prod<br>Nginx: server_tokens off</td>
                </tr>
                <tr>
                    <td>X-Powered-By</td>
                    <td>Revela tecnologia backend</td>
                    <td>Remover via configura√ß√£o ou c√≥digo</td>
                </tr>
                <tr>
                    <td>X-AspNet*</td>
                    <td>Revela vers√£o do ASP.NET</td>
                    <td>Desabilitar no web.config</td>
                </tr>
            </table>
            
            <p><strong>Configura√ß√µes espec√≠ficas:</strong></p>
            
            <p>Apache:</p>
            <pre>
# Ocultar vers√£o do servidor
ServerTokens Prod

# Remover cabe√ßalhos
Header unset X-Powered-By
Header unset Server</pre>
            
            <p>Nginx:</p>
            <pre>
# Ocultar vers√£o
server_tokens off;

# Remover cabe√ßalhos
more_clear_headers 'X-Powered-By';</pre>
            
            <p>Node.js (Express):</p>
            <pre>
// Desabilitar X-Powered-By
app.disable('x-powered-by');</pre>
            
            <p>PHP:</p>
            <pre>
// Remover X-Powered-By
header_remove('X-Powered-By');</pre>
        </div>
    </div>
    
    <div class="explanation">
        <h2>üìö Explica√ß√£o</h2>
        <p><strong>Problema:</strong> Cabe√ßalhos HTTP podem revelar informa√ß√µes sobre a stack tecnol√≥gica, permitindo que atacantes busquem vulnerabilidades espec√≠ficas para essas vers√µes.</p>
        <p><strong>Solu√ß√£o:</strong> Configurar servidores e aplica√ß√µes para n√£o revelar informa√ß√µes desnecess√°rias nos cabe√ßalhos.</p>
        <p><strong>Responsabilidade:</strong></p>
        <ul>
            <li><strong>Servidor:</strong> Configurar o servidor web para remover/modificar cabe√ßalhos sens√≠veis</li>
            <li><strong>Desenvolvedor:</strong> Configurar frameworks/APIs para n√£o expor informa√ß√µes desnecess√°rias</li>
        </ul>
    </div>

    <script>
        async function fetchVulnerableHeaders() {
            try {
                // Simular cabe√ßalhos de um servidor vulner√°vel
                const vulnerableHeaders = {
                    'Server': 'Apache/2.4.29 (Ubuntu)',
                    'X-Powered-By': 'PHP/7.2.24-0ubuntu0.18.04.6',
                    'X-AspNetMvc-Version': '5.2',
                    'Content-Type': 'text/html; charset=UTF-8'
                };
                
                let headersText = 'Cabe√ßalhos HTTP (simulados):\n';
                for (const [key, value] of Object.entries(vulnerableHeaders)) {
                    headersText += `${key}: ${value}\n`;
                }
                
                document.getElementById('vulnerableHeaders').innerHTML = 
                    `<div class="headers">${headersText}</div>
                     <p>Com essas informa√ß√µes, um atacante pode buscar vulnerabilidades conhecidas para:</p>
                     <ul>
                         <li>Apache 2.4.29</li>
                         <li>PHP 7.2.24</li>
                         <li>ASP.NET MVC 5.2</li>
                     </ul>`;
            } catch (error) {
                document.getElementById('vulnerableHeaders').innerHTML = 
                    `<p>Erro ao buscar cabe√ßalhos: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>